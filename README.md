# Yet Another Particle Transport IDE - converter

The Converter of the project file (JSON file generated by the frontend part) into a set of input files for particle transport simulators:

-   SHIELD-HIT12A (beam.dat, mat.dat, geo.dat and detect.dat).
-   TOPAS
-   Fluka

## Requirements

-   Python 3.9+
-   pip 21.3+
-   venv

## Installation

Project make use of poetry for dependency management. If you do not have it installed, check official [poetry installation guide](https://python-poetry.org/docs/).
Project is configured to create virtual environment for you, so you do not need to worry about it.
Virtual environment is created in `.venv` folder in the root of the project.

To install the project clone the repository and run the following command in the project directory:

```shell
poetry install --without=test
```

This will result in command `yaptide-converter` available inside the virtual environment.
It can be accessed outside virtual environment by running `poetry run yaptide-converter`.
Alternatively, you can run `poetry shell` to enter virtual environment or check more examples in [Poetry documentation section: Activating the virtual environment](https://python-poetry.org/docs/basic-usage#activating-the-virtual-environment).

## Usage

The converter comes with a command line application.
It is capable of transforming the JSON project file (generated in the yaptide web interface) into a set of valid input files for SHIELD-HIT12A.

To run the converter use the following command:

```bash
python converter/main.py tests/shieldhit/resources/project.json workspace
```

## Testing

To run the unit tests run the following command in the project directory (inside the virtual environment):

```bash
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
pip install -e .
pip install -r test_requirements.txt
pytest

# For Windowsfilecmp.cmp(tmp_path / filename, path_to_dir_with_expected_output / filename)
python -m venv venv
venv\Scripts\activate.bat
pip install -r requirements.txt
pip install -e .
pip install -r test_requirements.txt
pytest
```

## Credits

This work was partially funded by EuroHPC PL Project, Smart Growth Operational Programme 4.2
